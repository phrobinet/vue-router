<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Gardes de navigation | Vuepress Docs Boilerplate</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.e7a61a40.css" as="style"><link rel="preload" href="/assets/js/app.1e9eeef5.js" as="script"><link rel="preload" href="/assets/js/2.ca4c494e.js" as="script"><link rel="preload" href="/assets/js/18.1a2529fe.js" as="script"><link rel="prefetch" href="/assets/js/10.511a6a5d.js"><link rel="prefetch" href="/assets/js/11.f7e4b865.js"><link rel="prefetch" href="/assets/js/12.768e1784.js"><link rel="prefetch" href="/assets/js/13.0e035732.js"><link rel="prefetch" href="/assets/js/14.422259f4.js"><link rel="prefetch" href="/assets/js/15.9d5dbd3b.js"><link rel="prefetch" href="/assets/js/16.7c831878.js"><link rel="prefetch" href="/assets/js/17.9bf331d1.js"><link rel="prefetch" href="/assets/js/19.5fe2732b.js"><link rel="prefetch" href="/assets/js/20.0ffcc546.js"><link rel="prefetch" href="/assets/js/21.ea337eb6.js"><link rel="prefetch" href="/assets/js/22.65c44035.js"><link rel="prefetch" href="/assets/js/23.2ea98c70.js"><link rel="prefetch" href="/assets/js/24.d5654b10.js"><link rel="prefetch" href="/assets/js/25.92e2af2d.js"><link rel="prefetch" href="/assets/js/26.9133f23e.js"><link rel="prefetch" href="/assets/js/27.9d8b13a1.js"><link rel="prefetch" href="/assets/js/28.6754ece2.js"><link rel="prefetch" href="/assets/js/29.866a2606.js"><link rel="prefetch" href="/assets/js/3.17b065ec.js"><link rel="prefetch" href="/assets/js/30.7609fce7.js"><link rel="prefetch" href="/assets/js/31.761dd616.js"><link rel="prefetch" href="/assets/js/32.1c2747f6.js"><link rel="prefetch" href="/assets/js/33.3ad12a7e.js"><link rel="prefetch" href="/assets/js/34.5ceb7d82.js"><link rel="prefetch" href="/assets/js/4.4bb3b9f9.js"><link rel="prefetch" href="/assets/js/5.01e99829.js"><link rel="prefetch" href="/assets/js/6.d5cea1fa.js"><link rel="prefetch" href="/assets/js/7.d9bfb9f3.js"><link rel="prefetch" href="/assets/js/8.7fdcafc1.js"><link rel="prefetch" href="/assets/js/9.343cd259.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e7a61a40.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Vuepress Docs Boilerplate</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  API
</a></div><div class="nav-item"><a href="/migration/" class="nav-link">
  Migration
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/api/" class="nav-link">
  API
</a></div><div class="nav-item"><a href="/migration/" class="nav-link">
  Migration
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/installation.html" class="sidebar-link">Installation</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Essentiels</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Avancé</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="gardes-de-navigation"><a href="#gardes-de-navigation" class="header-anchor">#</a> Gardes de navigation</h1> <p>Comme son nom l'indique, les gardes de navigation fournies par Vue router sont principalement utilisées pour garder les navigations soit en les redirigeant, soit en les annulant. Il y a un certain nombre de façons de s'accrocher au processus de navigation de la route : globalement, par route, ou dans le composant.</p> <h2 id="avant-les-gardes-en-globale"><a href="#avant-les-gardes-en-globale" class="header-anchor">#</a> Avant les Gardes en globale</h2> <p>Vous pouvez enregistrer des gardes globales avant en utilisant <code>router.beforeEach</code> :</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token comment">// retourner explicitement false pour annuler la navigation</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Les gardes globales avant sont appelées dans l'ordre de création, chaque fois qu'une navigation est déclenchée. Les gardes peuvent être résolues de manière asynchrone, et la navigation est considérée comme <strong>en attente</strong> avant que tous les crochets aient été résolus.</p> <p>Chaque fonction de garde reçoit deux arguments :</p> <ul><li><strong><code>to</code></strong> : l'emplacement de l'itinéraire cible <a href="/api/#routelocationnormalized">dans un format normalisé</a> vers lequel on navigue.</li> <li><strong><code>from</code></strong> : l'emplacement actuel de l'itinéraire <a href="/api/#routelocationnormalized">dans un format normalisé</a> vers lequel on navigue.</li></ul> <p>Et peut éventuellement renvoyer l'une des valeurs suivantes :</p> <ul><li><code>false</code> : annule la navigation en cours. Si l'URL du navigateur a été modifiée (soit manuellement par l'utilisateur, soit via le bouton retour), elle sera réinitialisée à celle de l'itinéraire <code>from</code>.</li> <li>Un <a href="/api/#routelocationraw">emplacement de l'itinéraire</a> : Rediriger vers un emplacement différent en passant un emplacement de route comme si vous appeliez <a href="/api/#push"><code>router.push()</code></a>, ce qui vous permet de passer des options comme <code>replace : true</code> ou <code>name : 'home'</code>. La navigation actuelle est abandonnée et une nouvelle est créée avec le même <code>from</code>.</li></ul> <p>Il est également possible de lancer un <code>Error</code> si une situation inattendue a été rencontrée. Cela annulera également la navigation et appellera tout callback enregistré via <a href="/api/#onerror"><code>router.onError()</code></a>.</p> <p>Si rien, <code>undefined</code> ou <code>true</code> n'est retourné, <strong>la navigation est validée</strong>, et la prochaine garde de navigation est appelée.</p> <p>Tout ce qui précède <strong>fonctionne de la même manière avec les fonctions <code>async</code></strong> et les Promises :</p> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// canUserAccess() retourne `vrai` ou `faux`.</span>
  <span class="token keyword">const</span> canAccess <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">canUserAccess</span><span class="token punctuation">(</span>to<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>canAccess<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'/login'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="troisieme-argument-optionnel-next"><a href="#troisieme-argument-optionnel-next" class="header-anchor">#</a> Troisième argument optionnel <code>next</code></h3> <p>Dans les versions précédentes de Vue Router, il était également possible d'utiliser un troisième argument <code>next</code>, c'était une source fréquente d'erreurs et a fait l'objet d'un <a href="https://github.com/vuejs/rfcs/blob/master/active-rfcs/0037-router-return-guards.md#motivation" target="_blank" rel="noopener noreferrer">RFC<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> pour le supprimer. Cependant, il est toujours supporté, ce qui signifie que vous pouvez passer un troisième argument à n'importe quelle garde de navigation. Dans ce cas, <strong>vous devez appeler <code>next</code> exactement une fois</strong> dans chaque passage par un garde de navigation. Il peut apparaître plus d'une fois, mais seulement si les chemins logiques ne se chevauchent pas, sinon le hook ne sera jamais résolu ou produira des erreurs. Voici <strong>un mauvais exemple</strong> de redirection d'un utilisateur vers <code>/login</code> s'il n'est pas authentifié :</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// BAD</span>
router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>name <span class="token operator">!==</span> <span class="token string">'Login'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isAuthenticated<span class="token punctuation">)</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Login'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// si l'utilisateur n'est pas authentifié, `next` est appelé deux fois</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Voici la version correcte :</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// GOOD</span>
router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>name <span class="token operator">!==</span> <span class="token string">'Login'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isAuthenticated<span class="token punctuation">)</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Login'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">else</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="les-gardes-globales-de-resolution"><a href="#les-gardes-globales-de-resolution" class="header-anchor">#</a> Les Gardes globales de résolution</h2> <p>Vous pouvez enregistrer un garde globale avec <code>router.beforeResolve</code>. C'est similaire à <code>router.beforeEach</code> parce qu'il se déclenche sur <strong>chaque navigation</strong>, mais les gardes de résolution sont appelées juste avant que la navigation soit confirmée, <strong>après que toutes les gardes dans les composants et les composants de route asynchrones soient résolus</strong>. Voici un exemple qui garantit que l'utilisateur a donné accès à la caméra pour les routes qui <a href="/guide/advanced/meta.html">ont défini une méta personnalisée</a> propriété <code>requiresCamera</code> :</p> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token punctuation">.</span><span class="token function">beforeResolve</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">to</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>requiresCamera<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">await</span> <span class="token function">askForCameraPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token keyword">instanceof</span> <span class="token class-name">NotAllowedError</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ... gérer l'erreur et ensuite annuler la navigation</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// erreur inattendue, annule la navigation et passe l'erreur au gestionnaire global</span>
        <span class="token keyword">throw</span> error
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><code>router.beforeResolve</code> est l'endroit idéal pour récupérer des données ou effectuer toute autre opération que vous voulez éviter de faire si l'utilisateur ne peut pas entrer dans une page.</p> <h2 id="les-crochets-globaux-after"><a href="#les-crochets-globaux-after" class="header-anchor">#</a> Les Crochets globaux After</h2> <p>Vous pouvez également enregistrer des hooks globaux after, mais contrairement aux gardes, ces hooks n'ont pas de fonction <code>next</code> et ne peuvent pas affecter la navigation :</p> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token punctuation">.</span><span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">sendToAnalytics</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>fullPath<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div> <p>Ils sont utiles pour l'analyse, la modification du titre de la page, les fonctions d'accessibilité comme l'annonce de la page et bien d'autres choses.</p> <p>Ils reflètent également les <a href="/guide/advanced/navigation-failures.html">échecs de navigation</a> comme troisième argument :</p> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token punctuation">.</span><span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> failure</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>failure<span class="token punctuation">)</span> <span class="token function">sendToAnalytics</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>fullPath<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Pour en savoir plus sur les échecs de navigation, consultez <a href="/guide/advanced/navigation-failures.html">son guide</a>.</p> <h2 id="un-garde-par-route"><a href="#un-garde-par-route" class="header-anchor">#</a> Un Garde par route</h2> <p>Vous pouvez définir des gardes <code>beforeEnter</code> directement sur l'objet de configuration d'une route :</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/users/:id'</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> UserDetails<span class="token punctuation">,</span>
    <span class="token function-variable function">beforeEnter</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
       <span class="token comment">// rejeter la navigation</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre></div><p>Les gardes <code>beforeEnter</code> <strong>se déclenchent uniquement lors de l'entrée dans l'itinéraire</strong>, elles ne se déclenchent pas lorsque les <code>params</code>, <code>query</code> ou <code>hash</code> changent, par exemple en passant de <code>/users/2</code> à <code>/users/3</code> ou en passant de <code>/users/2#info</code> à <code>/users/2#projects</code>. Ils ne sont déclenchés que lorsque vous naviguez <strong>à partir d'une route différente</strong>.</p> <p>Vous pouvez également passer un tableau de fonctions à <code>beforeEnter</code>, ceci est utile lorsque vous réutilisez des gardes pour différentes routes :</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">removeQueryParams</span><span class="token punctuation">(</span><span class="token parameter">to</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> path<span class="token operator">:</span> to<span class="token punctuation">.</span>path<span class="token punctuation">,</span> query<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> hash<span class="token operator">:</span> to<span class="token punctuation">.</span>hash <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">removeHash</span><span class="token punctuation">(</span><span class="token parameter">to</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>hash<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span> path<span class="token operator">:</span> to<span class="token punctuation">.</span>path<span class="token punctuation">,</span> query<span class="token operator">:</span> to<span class="token punctuation">.</span>query<span class="token punctuation">,</span> hash<span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/users/:id'</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> UserDetails<span class="token punctuation">,</span>
    beforeEnter<span class="token operator">:</span> <span class="token punctuation">[</span>removeQueryParams<span class="token punctuation">,</span> removeHash<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/about'</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> UserDetails<span class="token punctuation">,</span>
    beforeEnter<span class="token operator">:</span> <span class="token punctuation">[</span>removeQueryParams<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre></div><p>Notez qu'il est possible d'obtenir un comportement similaire en utilisant les <a href="/guide/advanced/meta.html">champs méta de la route</a> et les <a href="#global-before-guards">gardes de navigation globale</a>.</p> <h2 id="les-gardes-a-l-interieur-des-composants"><a href="#les-gardes-a-l-interieur-des-composants" class="header-anchor">#</a> Les Gardes à l'intérieur des composants</h2> <p>Enfin, vous pouvez définir directement des gardes de navigation à l'intérieur des composants de route (ceux passés à la configuration du routeur)</p> <h3 id="utilisation-de-l-api-d-options"><a href="#utilisation-de-l-api-d-options" class="header-anchor">#</a> Utilisation de l'API d'options</h3> <p>Vous pouvez ajouter les options suivantes aux composants de route :</p> <ul><li><code>beforeRouteEnter</code></li> <li><code>beforeRouteUpdate</code></li> <li><code>beforeRouteLeave</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> UserDetails <span class="token operator">=</span> <span class="token punctuation">{</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">...</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token function">beforeRouteEnter</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// appelé avant que la route qui rend ce composant soit confirmée.</span>
    <span class="token comment">// n'a PAS accès à l'instance du composant `this`,</span>
    <span class="token comment">// car elle n'a pas encore été créée lorsque cette garde est appelée !</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">beforeRouteUpdate</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// appelé lorsque la route qui rend ce composant a changé,</span>
    <span class="token comment">// mais ce composant est réutilisé dans la nouvelle route.</span>
    <span class="token comment">// Par exemple, pour une route avec les paramètres `/users/:id`, lorsque nous</span>
    <span class="token comment">// naviguons entre `/users/1` et `/users/2`, la même instance du composant `UserDetails` sera réutilisée.</span>
    <span class="token comment">// sera réutilisée, et ce hook sera appelé à ce moment-là.</span>
    <span class="token comment">// Comme le composant est monté pendant que cela se produit, le garde de navigation a accès à `cette` instance de composant.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">beforeRouteLeave</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// appelé lorsque la route qui rend ce composant est sur le point de</span>
    <span class="token comment">// être éloigné de la route.</span>
    <span class="token comment">// Comme pour `beforeRouteUpdate`, il a accès à l'instance du composant `this`.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Le garde <code>beforeRouteEnter</code> n'a <strong>PAS</strong> accès à <code>this</code>, car le garde est appelé avant que la navigation ne soit confirmée, donc le nouveau composant entrant n'a même pas encore été créé.</p> <p>Cependant, vous pouvez accéder à l'instance en passant une callback à <code>next</code>. La callback sera appelée lorsque la navigation sera confirmée, et l'instance du composant sera passée à la callback comme argument :</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">beforeRouteEnter</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token parameter">vm</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// accès à l'instance publique du composant via `vm`.</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Notez que <code>beforeRouteEnter</code> est la seule garde qui supporte de passer un callback à <code>next</code>. Pour <code>beforeRouteUpdate</code> et <code>beforeRouteLeave</code>, <code>this</code> est déjà disponible, donc passer un callback est inutile et donc <em>non supporté</em> :</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">beforeRouteUpdate</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// utilisez simplement `this`</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> to<span class="token punctuation">.</span>params<span class="token punctuation">.</span>name
<span class="token punctuation">}</span>
</code></pre></div><p>La <strong>protection contre le départ</strong> est généralement utilisée pour empêcher l'utilisateur de quitter accidentellement l'itinéraire avec des modifications non sauvegardées. La navigation peut être annulée en retournant <code>false</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">beforeRouteLeave</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> answer <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'Do you really want to leave? you have unsaved changes!'</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>answer<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="utilisation-de-l-api-de-composition"><a href="#utilisation-de-l-api-de-composition" class="header-anchor">#</a> Utilisation de l'API de composition</h3> <p>Si vous écrivez votre composant en utilisant l'<a href="https://v3.vuejs.org/guide/composition-api-setup.html#setup" target="_blank" rel="noopener noreferrer">API de composition et une fonction <code>setup</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, vous pouvez ajouter des gardes de mise à jour et de départ par le biais de <code>onBeforeRouteUpdate</code> et <code>onBeforeRouteLeave</code> respectivement. Veuillez consulter la section <a href="/guide/advanced/composition-api.html#navigation-guards">Composition API</a> pour plus de détails.</p> <h2 id="le-flux-complet-de-resolution-de-la-navigation"><a href="#le-flux-complet-de-resolution-de-la-navigation" class="header-anchor">#</a> Le flux complet de résolution de la navigation</h2> <ol><li>Navigation déclenchée.</li> <li>Appel des gardes <code>beforeRouteLeave</code> dans les composants désactivés.</li> <li>Appel des gardes globales <code>beforeEach</code>.</li> <li>Appeler les gardes <code>beforeRouteUpdate</code> dans les composants réutilisés.</li> <li>Appeler les gardes <code>beforeEnter</code> dans les configurations de route.</li> <li>Résoudre les composants de route asynchrones.</li> <li>Appeler <code>beforeRouteEnter</code> dans les composants activés.</li> <li>Appeler les gardes globales <code>beforeResolve</code>.</li> <li>La navigation est confirmée.</li> <li>Appelle les crochets globaux <code>afterEach</code>.</li> <li>Les mises à jour du DOM sont déclenchées.</li> <li>Appel des callbacks passés à <code>next</code> dans les gardes <code>beforeRouteEnter</code> avec les instances instanciées.</li></ol></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1e9eeef5.js" defer></script><script src="/assets/js/2.ca4c494e.js" defer></script><script src="/assets/js/18.1a2529fe.js" defer></script>
  </body>
</html>
